- ğŸ‘‹ Hi, Iâ€™m @lehao2806
- ğŸ‘€ Iâ€™m interested in ...
- ğŸŒ± Iâ€™m currently learning ...
- ğŸ’ï¸ Iâ€™m looking to collaborate on ...
- ğŸ“« How to reach me ...

<!---
lehao2806/lehao2806 is a âœ¨ special âœ¨ repository because its `README.md` (this file) appears on your GitHub profile.
You can click the Preview link to take a look at your changes.
--->

--Anh/chá»‹ hÃ£y táº¡o 1 View V_KHACHHANG yÃªu cáº§u cÃ³ cÃ¡c thÃ´ng tin nhÆ° sau:
--MA_KHACH_HANG, TEN_KHACH_HANG
--DIA_CHI (Chá»‰ cÃ³ 10 chá»¯ cÃ¡i Ä‘áº§u tiÃªn Ä‘Æ°á»£c hiá»ƒn thá»‹) SUBSTR
--SO_DIEN_THOAI (Hiá»ƒn thá»‹ '09xx.xxx.xxx' cho toÃ n bá»™ KH)
--NAM_SINH (Chá»‰ hiá»ƒn thá»‹ duy nháº¥t NÄƒm sinh khÃ´ng cÃ³ ngÃ y thÃ¡ng)

CREATE VIEW V_KHACHHANG AS
SELECT 
 [MAKH] AS MA_KHACH_HANG
,[HOTEN] AS TEN_KHACH_HANG
,SUBSTRING([DCHI],1,10) AS DIA_CHI
,'09xx.xxx.xxx' AS SO_DIEN_THOAI
,YEAR([NGSINH]) AS NAM_SINH
FROM KHACHHANG;

SELECT * FROM [dbo].[V_KHACHHANG];
--BÃ€I Táº¬P 2
--Äá»ƒ Ä‘Ã¡nh giÃ¡ nhÃ¢n viÃªn xuáº¥t sáº¯c
--Anh/chá»‹ hÃ£y viáº¿t 1 view Ä‘áº·t tÃªn lÃ  V_TONGKETKD cÃ³ cÃ¡c thÃ´ng tin sau
--MA_NHAN_VIEN, HO_VA_TEN
--TONG_SO_HD (TÃ­nh tá»•ng lÆ°á»£ng hÃ³a Ä‘Æ¡n mÃ  nhÃ¢n viÃªn bÃ¡n Ä‘Æ°á»£c)
--TONG_DOANH_THU (TÃ­nh tá»•ng doanh thu mÃ  nhÃ¢n viÃªn bÃ¡n Ä‘Æ°á»£c)

create view V_TONGKETKD as
select 
NV.MANV as MA_NHAN_VIEN,
HOTEN as HO_VA_TEN,
COUNT(HD.[SOHD]) as TONG_SO_HD,
SUM(HD.[TRIGIA]) as TONG_DOANH_THU
from [dbo].[NHANVIEN] as NV
inner join HOADON as HD on nv.MANV = hd.MANV
group by NV.MANV, HOTEN;

select * from [dbo].[V_TONGKETKD];

--BÃ€I Táº¬P 3
---Sá»¬ Dá»¤NG CSDL BANHANG Má»šI IMPORT Äá»‚ LÃ€M
--Äá»ƒ Ä‘Ã¡nh giÃ¡ tÃ¬nh hÃ¬nh kinh doanh tá»« nÄƒm 2018 trá»Ÿ láº¡i Ä‘Ã¢y cá»§a há»‡ thá»‘ng
--Anh/chá»‹ hÃ£y viáº¿t 1 cÃ¢u lá»‡nh duy nháº¥t Ä‘á»ƒ hiá»‡n thá»‹ Ä‘áº§y Ä‘á»§ cÃ¡c thÃ´ng tin sau
--NÄƒm
--MÃ£ chi nhÃ¡nh, ngÆ°á»i quáº£n lÃ½
--MÃ£ nhÃ¢n viÃªn, Há» tÃªn nhÃ¢n viÃªn
--Tá»•ng sá»‘ tiá»n nhÃ¢n viÃªn bÃ¡n Ä‘Æ°á»£c
--Sá»‘ tiá»n hoa há»“ng cao nháº¥t mÃ  1 nhÃ¢n viÃªn nháº­n Ä‘Æ°á»£c 
--tá»« 1 giao dá»‹ch lÃ  bao nhiÃªu biáº¿t Sá»‘ tiá»n hoa há»“ng = STMHNT * Hoahong / 100

SELECT YEAR(TRANS_TIME) NAM_GIAO_DICH,
[Store ID] AS MA_CUA_HANG,
CN.[Quáº£n lÃ½] AS TEN_QUAN_LY,
BH.Sale_man_ID AS MA_NV,
BH.Sale_man AS TEN_NV,
SUM([Sá»‘ tiá»n Mua hÃ ng nguyÃªn tá»‡]) AS TONG_TIEN_BAN,
MAX([Sá»‘ tiá»n Mua hÃ ng nguyÃªn tá»‡]*[Hoa há»“ng]/100) AS HOA_HONG_CAO_NHAT
FROM BANHANG BH
INNER JOIN CHINHANH CN ON BH.[Store ID] = CN.[MÃ£ cá»­a hÃ ng]
WHERE YEAR(TRANS_TIME) >= 2018
GROUP BY YEAR(TRANS_TIME),[Store ID],CN.[Quáº£n lÃ½],BH.Sale_man_ID,BH.Sale_man
HAVING SUM([Sá»‘ tiá»n Mua hÃ ng nguyÃªn tá»‡]) > 100000000
ORDER BY YEAR(TRANS_TIME), [Store ID], CN.[Quáº£n lÃ½], BH.Sale_man_ID
